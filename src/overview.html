<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="assets/img/talos_logo_icon.png">
    <title>Talos</title>
    <link rel="stylesheet" type="text/css" href="assets/lib/perfect-scrollbar/css/perfect-scrollbar.css"/>
    <link rel="stylesheet" type="text/css" href="assets/lib/material-design-icons/css/material-design-iconic-font.min.css"/>
    <link rel="stylesheet" href="assets/css/app.css" type="text/css"/>

    <style type="text/css">
      
      .ui-sparkline {
  font-family:"Segoe UI", Arial, sans-serif;
  font-size:12px;
  background: rgba(255,255,255,0) !important;
  padding:10px 5px 10px 5px;
}


    </style>


  </head>
  <body>
    <div class="be-wrapper">
      <nav class="navbar navbar-expand fixed-top be-top-header">
        <div class="container-fluid">
          <div class="be-navbar-header"><a class="navbar-brand" href="index.html"></a>
          </div>
          <div class="be-right-navbar">
            <ul class="nav navbar-nav float-right be-icons-nav">

              <li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" data-toggle="dropdown" role="button" aria-expanded="false"><span class="icon mdi mdi-apps"></span></a>

                <ul class="dropdown-menu be-connections">
                  <li>
                    <div class="list">
                      <div class="content">
                        <div class="row">
                          <div class="col"><a class="connection-item" href="https://github.com/autonomio/talos/issues/new"><img src="assets/img/github.png" alt="Github"><span>Issues</span></a></div>
                          <div class="col"><a class="connection-item" href="https://spectrum.chat/talos?tab=posts"><img src="assets/img/spectrum.svg" alt="Bitbucket"><span>Chat</span></a></div>
                          <div class="col"><a class="connection-item" href="https://autonomio.github.io/talos/#/"><img src="assets/img/talos_logo_icon.png" alt="Slack"><span>Docs</span></a></div>
                        </div>
                      </div>
                    </div>
                  </li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </nav>
      <div class="be-left-sidebar">
        <div class="left-sidebar-wrapper"><a class="left-sidebar-toggle" href="#">Blank Page</a>
          <div class="left-sidebar-spacer">
            <div class="left-sidebar-scroll">
              <div class="left-sidebar-content">
                <ul class="sidebar-elements">
                  <li class="parent"><a href="#"><i class="icon mdi mdi-graphic-eq"></i><span>results</span></a>
                    <ul class="sub-menu">

                      <!-- results menu starts -->

                      <li class="active"><a href="overview.html">Overview</a></li>
                      <li><a href="experiment_log.html">Experiment Log</a></li>
                      <li><a href="custom_reports.html">Custom Reports</a></li>
                    </ul>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="progress-widget">
            <div class="progress-data"><span class="progress-value">60%</span><span class="name">Current Progress</span></div>
            <div class="progress">
              <div class="progress-bar progress-bar-primary" style="width: 60%;"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="be-content">
        <div class="main-content container-fluid">
        

          <!-- header selector content starts -->

          <div class="form-group row pt-1">
            <div class="col-3" id="header_dd_left">
              <select class="form-control" onchange="left_dd(this);">
                <option v-for="todo in todos"> {{ todo }}</option>
              </select>
            </div>
            <div class="col-3" id="header_dd_right">
              <select class="form-control" onchange="right_dd(this);">
                <option v-for="todo in todos"> {{ todo }}</option>
              </select>
            </div>
          </div>


          <!-- sparklines content starts -->

          <div class="row">
            <div class="col-12 col-lg-6 col-xl-3">
                        <div class="widget widget-tile card card-border-color card-border-color-warning">
                          <div class="chart sparkline" id="spark1">0,5,3,7,5,10,3,6,5,10</div>
                          <div class="data-info">
                            <div class="desc">best <span id='best_a_label'></span></div>
                            <div class="value"><span class="indicator indicator-equal mdi mdi-chevron-right"></span><span class="number" id="best_a"></span>
                            </div>
                          </div>
                        </div>
            </div>

            <div class="col-12 col-lg-6 col-xl-3">
                        <div class="widget widget-tile card card-border-color card-border-color-warning">
                          <div class="chart sparkline" id="spark3">2,3,4,5,4,3,2,3,4,5,6,5,4,3,4,5,6,5,4,4,5</div>
                          <div class="data-info">
                            <div class="desc">best <span id='best_b_label'></span></div>
                            <div class="value"><span class="indicator indicator-positive mdi mdi-chevron-up"></span><span class="number" id="best_b"></span>
                            </div>
                          </div>
                        </div>
            </div>


            <div class="col-12 col-lg-6 col-xl-3">
                        <div class="widget widget-tile card card-border-color card-border-color-warning">
                          <div class="chart sparkline" id="spark2">5,8,7,10,9,10,8,6,4,6,8,7,6,8</div>
                          <div class="data-info">
                            <div class="desc">mean <span id='mean_a_label'></span></div>
                            <div class="value"><span class="indicator indicator-positive mdi mdi-chevron-up"></span><span class="number" id="mean_a"></span>
                            </div>
                          </div>
                        </div>
            </div>

            <div class="col-12 col-lg-6 col-xl-3 ">
                        <div class="widget widget-tile card card-border-color card-border-color-warning">
                          <div class="chart sparkline" id="spark4">2,5,3,7,5,10,3,6,5,7</div>
                          <div class="data-info">
                            <div class="desc">mean <span id='mean_b_label'></span></div>
                            <div class="value"><span class="indicator indicator-negative mdi mdi-chevron-down"></span><span class="number" id="mean_b"></span>
                            </div>
                          </div>
                        </div>
            </div>
          </div>
          <div class="row">
            <div class="col-12">
              <div class="card card-border-color card-border-color-warning">
                <div class="card-body">
                <canvas id="myChart"></canvas>
                </div>
              </div>
            </div>




          
        


        </div>
      </div>
    </div>

    <!-- scripts start here -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.7.0/d3.min.js"></script>
    <script src="assets/lib/jquery/jquery.min.js" type="text/javascript"></script>
    <script src="assets/lib/perfect-scrollbar/js/perfect-scrollbar.min.js" type="text/javascript"></script>
    <script src="assets/lib/bootstrap/dist/js/bootstrap.bundle.min.js" type="text/javascript"></script>
    <script src="assets/js/app.js" type="text/javascript"></script>
    <script src="assets/lib/jquery.sparkline/jquery.sparkline.min.js" type="text/javascript"></script>
    <script src="assets/js/app-charts-sparkline.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>


    <script type="text/javascript">
      $(document).ready(function(){
      	//-initialize the javascript
      	App.init();
        App.chartsSparklines();
      });


      
    function range(start, end) {
      var ans = [];
      for (let i = start; i <= end; i++) {
          ans.push(i);
      }
      return ans;
    }

    function avg(a) {
      return a.reduce((a, b) => a + b, 0) / a.length
    }

    var filename = 'https://raw.githubusercontent.com/autonomio/examples/master/telco_churn/telco_churn_for_sensitivity.csv'

    d3.csv(filename).then(prepSelectors);


    function prepSelectors(dataset) {

      // create global variable
      window.dataset = dataset

      // get the headers
      var keys = Object.keys(dataset[0])

      // populate the left header selector
      var header_dd_left = new Vue({
        el: '#header_dd_left',
        data: {
          todos: keys
        }
      })

      // populate the right header selector
      var header_dd_right = new Vue({
        el: '#header_dd_right',
        data: {
          todos: keys
        }
      })

      prepData(dataset)

    };

    function prepData(dataset) {

      label_a = 'val_acc'
      label_b = 'val_loss'

      // pick the data 
      var a = dataset.map(function(d) {return d[label_a]});
      var b = dataset.map(function(d) {return d[label_b]});

      makeChart(a, b)
      updateSparksA(a, label_a)
      updateSparksB(b, label_b)

    };

    function updateSparksA(a, label) { 

      a = a.map(num => Number(num))
      best_a = Math.max.apply(Math, a)
      javascript:document.getElementById('best_a').innerHTML = best_a.toFixed(3)
      javascript:document.getElementById('mean_a').innerHTML = avg(a).toFixed(3)
      javascript:document.getElementById('best_a_label').innerHTML = label
      javascript:document.getElementById('mean_a_label').innerHTML = label

    };

    function updateSparksB(b, label) { 
      
      b = b.map(num => Number(num))
      best_b = Math.min.apply(Math, b)
      javascript:document.getElementById('best_b').innerHTML = best_b.toFixed(3)
      javascript:document.getElementById('mean_b').innerHTML = avg(b).toFixed(3)
      javascript:document.getElementById('best_b_label').innerHTML = label
      javascript:document.getElementById('mean_b_label').innerHTML = label

    };

  




  var ctx = document.getElementById('myChart').getContext('2d');
  function makeChart(a, b) {
      var myChart = new Chart(ctx, {
        type: 'line',
        options: {
                responsive: true,
                legend: {
                    position: 'top',
                    fontSize: 20
                },
                hover: {
                    mode: 'label'
                },
                scales: {
                    xAxes: [{
                            display: true,
                            scaleLabel: {
                                display: true,
                                labelString: 'Model ID',
                                beginAtZero: true,
                            }
                        }],
                    yAxes: [{
                            display: true,
                            ticks: {
                                beginAtZero: true,
                                steps: 10,
                                stepValue: 0.1,
                                max: 1,
                                fontSize: 16
                            }
                        }]
                },
                title: {
                    //display: true,
                    // text: 'Model Validation Performance',
                    fontSize: 20,
                }
            },
        data: {
          labels: range(1, b.length),
          color: ['red'],
          datasets: [
            {
              label: 'val_f1score',
              backgroundColor: 'rgba(98, 98, 98, .6)',
              data: a,
              showLine: false,
              pointBorderColor: 'rgba(98, 98, 98, 1)',
            },
            {
              label: 'val_loss',
              backgroundColor: 'rgba(195, 73, 68, .6)',
              data: b,
              showLine: false,
              pointBorderColor: 'rgba(195, 73, 68, 1)',
            }
          ]
        }
      });

    window.chart = myChart

    }

    function left_dd(sel) {
        var a = window.dataset.map(function(d) {return d[sel.value]});
        window.chart.data.datasets[0].data = a;
        window.chart.data.datasets[0].label = sel.value;
        window.chart.update();
        updateSparksA(a, sel.value)
      
    }

    function right_dd(sel) {
        var b = window.dataset.map(function(d) {return d[sel.value]});
        window.chart.data.datasets[1].data = b;
        window.chart.data.datasets[1].label = sel.value;
        window.chart.update();
        updateSparksB(b, sel.value)
    }

    </script>
  </body>
</html>